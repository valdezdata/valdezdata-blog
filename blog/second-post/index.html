<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asegurando la Integridad de Datos con dbt Tests | VALDEZDATA</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/prism-tokyo-night.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="VALDEZDATA Blog">
</head>
<body>
  <div class="terminal">
    <div class="terminal-header">
      <div class="terminal-buttons">
        <div class="terminal-button red"></div>
        <div class="terminal-button yellow"></div>
        <div class="terminal-button green"></div>
      </div>
      <div class="terminal-title">valdezdata@blog:~</div>
    </div>
    
    <div class="terminal-content">
      <div class="ascii-header">
        <a href="/" class="ascii-link">
        <pre>
â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•   â–ˆâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
 â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
  â•šâ•â•â•â•  â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•
        </pre>
        </a>
      </div>
      
      <div class="typing-container">
        <div class="typing-text" id="typing-text"></div>
        <div class="cursor"></div>
      </div>
      
      <div class="tags-container" id="tags-container">
        <!-- Tags will be added dynamically by JavaScript -->
      </div>
      
      <nav class="terminal-nav">
        <ul>
          <li><a href="/">> home</a></li>
          <li><a href="/whoami/">> whoami</a></li>
          <li><a href="/usos/">> Usos</a></li>
          <li><a href="/tags/">> tags</a></li>
          <li><a href="/feed.xml">> RSS</a></li>
        </ul>
      </nav>
      
      <div class="content">
        
<article class="post">
  <h1 class="post-header">Asegurando la Integridad de Datos con dbt Tests</h1>
  
  <div class="post-meta">
    <time datetime="Feb 9, 2023">Feb 9, 2023</time>
    
      â€¢ 
      
        
          <a href="/tags/data-integrity/" class="tag">data-integrity</a> 
        
      
        
          <a href="/tags/dbt/" class="tag">dbt</a> 
        
      
        
          <a href="/tags/testing/" class="tag">testing</a>
        
      
    
  </div>
  
  <div class="post-content">
    <h1>Asegurando la Integridad de Datos con dbt Tests</h1>
<p>En el mundo de los datos, la confianza es fundamental. Para que los stakeholders tomen decisiones basadas en datos, necesitan tener plena confianza en la integridad de esos datos. AquÃ­ es donde dbt (data build tool) y su sistema de pruebas se vuelven esenciales para cualquier stack moderno de datos.</p>
<h2>Â¿Por quÃ© necesitamos pruebas de datos?</h2>
<p>Sin pruebas sistemÃ¡ticas, los problemas comunes incluyen:</p>
<ul>
<li>Valores duplicados en columnas que deberÃ­an ser Ãºnicas</li>
<li>Referencias huÃ©rfanas a registros que no existen</li>
<li>Valores nulos en campos crÃ­ticos</li>
<li>AnomalÃ­as estadÃ­sticas o outliers</li>
</ul>
<h2>Pruebas incorporadas en dbt</h2>
<p>dbt viene con cuatro pruebas genÃ©ricas que pueden solucionar la mayorÃ­a de los casos de uso bÃ¡sicos:</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token comment"># models/schema.yml</span>
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">2</span>

<span class="token key atrule">models</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> customers
    <span class="token key atrule">columns</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> customer_id
        <span class="token key atrule">tests</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> unique
          <span class="token punctuation">-</span> not_null

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> plan_type
        <span class="token key atrule">tests</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">accepted_values</span><span class="token punctuation">:</span>
              <span class="token key atrule">values</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"free"</span><span class="token punctuation">,</span> <span class="token string">"starter"</span><span class="token punctuation">,</span> <span class="token string">"professional"</span><span class="token punctuation">,</span> <span class="token string">"enterprise"</span><span class="token punctuation">]</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service_rep_id
        <span class="token key atrule">tests</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">relationships</span><span class="token punctuation">:</span>
              <span class="token key atrule">to</span><span class="token punctuation">:</span> ref('service_reps')
              <span class="token key atrule">field</span><span class="token punctuation">:</span> id</code></pre>
<h2>Pruebas personalizadas para lÃ³gica de negocio</h2>
<p>Las pruebas incorporadas son solo el comienzo. Para reglas de negocio especÃ­ficas, podemos crear pruebas personalizadas en SQL:</p>
<pre class="language-sql"><code class="language-sql"><span class="token comment">-- tests/total_should_match_detail.sql</span>
<span class="token comment">-- Ejemplo de una prueba personalizada en SQL:</span>

<span class="token keyword">with</span>
total_values <span class="token keyword">as</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>
        order_id<span class="token punctuation">,</span>
        total_amount
    <span class="token keyword">from</span> orders
<span class="token punctuation">)</span><span class="token punctuation">,</span>

detail_values <span class="token keyword">as</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>
        order_id<span class="token punctuation">,</span>
        <span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">as</span> detail_total
    <span class="token keyword">from</span> order_items
    <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span>

mismatches <span class="token keyword">as</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>
        t<span class="token punctuation">.</span>order_id<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>total_amount<span class="token punctuation">,</span>
        d<span class="token punctuation">.</span>detail_total<span class="token punctuation">,</span>
        abs<span class="token punctuation">(</span>t<span class="token punctuation">.</span>total_amount <span class="token operator">-</span> d<span class="token punctuation">.</span>detail_total<span class="token punctuation">)</span> <span class="token keyword">as</span> diff
    <span class="token keyword">from</span> total_values t
    <span class="token keyword">join</span> detail_values d <span class="token keyword">on</span> t<span class="token punctuation">.</span>order_id <span class="token operator">=</span> d<span class="token punctuation">.</span>order_id
    <span class="token keyword">where</span> abs<span class="token punctuation">(</span>t<span class="token punctuation">.</span>total_amount <span class="token operator">-</span> d<span class="token punctuation">.</span>detail_total<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.01</span>
<span class="token punctuation">)</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> mismatches</code></pre>
<h2>ImplementaciÃ³n en tu flujo de trabajo</h2>
<p>Para integrar las pruebas en tu pipeline:</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Ejecutar todas las pruebas</span>
dbt <span class="token builtin class-name">test</span>

<span class="token comment"># Ejecutar pruebas especÃ­ficas</span>
dbt <span class="token builtin class-name">test</span> <span class="token parameter variable">--models</span> customers

<span class="token comment"># Pruebas como parte del CI/CD</span>
dbt build  <span class="token comment"># combina dbt run y dbt test</span></code></pre>
<h2>Monitoreando la calidad de datos a lo largo del tiempo</h2>
<p>Las pruebas puntuales son Ãºtiles, pero el monitoreo continuo es mejor:</p>
<ol>
<li>Programa ejecuciones de pruebas regulares (diarias/horarias)</li>
<li>Integra alertas cuando fallen las pruebas</li>
<li>Construye dashboards de calidad de datos</li>
</ol>
<h2>ConclusiÃ³n</h2>
<p>Invertir en pruebas de datos desde el principio paga dividendos enormes a largo plazo: mejora la confianza, reduce el tiempo de depuraciÃ³n y permite refactorizar con confianza. dbt proporciona las herramientas necesarias para implementar una cultura de calidad de datos en tu organizaciÃ³n.</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"Datos confiables, decisiones confiables."</span> <span class="token operator">></span> /dev/stdout</code></pre>

  </div>
  
  <div class="post-navigation">
    <a href="/">> cd ..</a>
  </div>
</article>

      </div>
      
      <div class="terminal-footer">
        <p>Â© 2025 VALDEZDATA - Built with <a href="https://www.11ty.dev/">11ty</a> and ğŸ’™</p>
      </div>
    </div>
  </div>
  
  <script src="/js/terminal.js"></script>
</body>
</html>
