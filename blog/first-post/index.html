<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Construyendo Data Pipelines Resilientes con Airflow | VALDEZDATA</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/prism-tokyo-night.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="VALDEZDATA Blog">
</head>
<body>
  <div class="terminal">
    <div class="terminal-header">
      <div class="terminal-buttons">
        <div class="terminal-button red"></div>
        <div class="terminal-button yellow"></div>
        <div class="terminal-button green"></div>
      </div>
      <div class="terminal-title">valdezdata@blog:~</div>
    </div>
    
    <div class="terminal-content">
      <div class="ascii-header">
        <a href="/" class="ascii-link">
        <pre>
â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•   â–ˆâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
 â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
  â•šâ•â•â•â•  â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•
        </pre>
        </a>
      </div>
      
      <div class="typing-container">
        <div class="typing-text" id="typing-text"></div>
        <div class="cursor"></div>
      </div>
      
      <div class="tags-container" id="tags-container">
        <!-- Tags will be added dynamically by JavaScript -->
      </div>
      
      <nav class="terminal-nav">
        <ul>
          <li><a href="/">> home</a></li>
          <li><a href="/whoami/">> whoami</a></li>
          <li><a href="/usos/">> Usos</a></li>
          <li><a href="/tags/">> tags</a></li>
          <li><a href="/feed.xml">> RSS</a></li>
        </ul>
      </nav>
      
      <div class="content">
        
<article class="post">
  <h1 class="post-header">Construyendo Data Pipelines Resilientes con Airflow</h1>
  
  <div class="post-meta">
    <time datetime="Jan 14, 2023">Jan 14, 2023</time>
    
      â€¢ 
      
        
          <a href="/tags/data-engineering/" class="tag">data-engineering</a> 
        
      
        
          <a href="/tags/airflow/" class="tag">airflow</a> 
        
      
        
          <a href="/tags/python/" class="tag">python</a>
        
      
    
  </div>
  
  <div class="post-content">
    <h1>Construyendo Data Pipelines Resilientes con Airflow</h1>
<p>En el mundo de la ingenierÃ­a de datos, la resiliencia no es negociable. Los pipelines de datos deben funcionar de manera confiable, incluso cuando ocurren fallos inevitables. Apache Airflow se ha convertido en una herramienta estÃ¡ndar para orquestar pipelines complejos, pero construir flujos verdaderamente resilientes requiere mÃ¡s que simplemente definir DAGs.</p>
<h2>El Problema de los Pipelines FrÃ¡giles</h2>
<p>Muchos pipelines de datos fallan por razones predecibles:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># âŒ Pipeline frÃ¡gil sin manejo de errores</span>
<span class="token keyword">def</span> <span class="token function">extract_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Si la API falla, todo el pipeline falla</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span>
    response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h2>Implementando Retries Inteligentes</h2>
<p>Airflow permite implementar retries a nivel de tarea:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># âœ… Tarea con retries configurados</span>
extract_task <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
    task_id<span class="token operator">=</span><span class="token string">'extract_data'</span><span class="token punctuation">,</span>
    python_callable<span class="token operator">=</span>extract_data<span class="token punctuation">,</span>
    retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
    retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    retry_exponential_backoff<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    dag<span class="token operator">=</span>dag
<span class="token punctuation">)</span></code></pre>
<h2>Estrategias de Idempotencia</h2>
<p>Una clave para la resiliencia es la idempotencia - la capacidad de ejecutar un proceso mÃºltiples veces sin efectos secundarios:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># âœ… FunciÃ³n idempotente</span>
<span class="token keyword">def</span> <span class="token function">load_to_warehouse</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> execution_date<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Usar una clave temporal para garantizar idempotencia</span>
    date_key <span class="token operator">=</span> execution_date<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>

    <span class="token comment"># Primero eliminar registros existentes de este perÃ­odo</span>
    warehouse<span class="token punctuation">.</span>delete_where<span class="token punctuation">(</span>date<span class="token operator">=</span>date_key<span class="token punctuation">)</span>

    <span class="token comment"># Luego insertar los nuevos datos</span>
    warehouse<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>data<span class="token punctuation">,</span> date<span class="token operator">=</span>date_key<span class="token punctuation">)</span></code></pre>
<h2>Monitoreo y Alertas</h2>
<p>La resiliencia tambiÃ©n requiere visibilidad. Configurar alertas efectivas es crucial:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># ConfiguraciÃ³n de alertas en Airflow</span>
default_args <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'owner'</span><span class="token punctuation">:</span> <span class="token string">'data_team'</span><span class="token punctuation">,</span>
    <span class="token string">'depends_on_past'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token string">'email'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'alerts@company.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'email_on_failure'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
    <span class="token string">'email_on_retry'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre>
<h2>ConclusiÃ³n</h2>
<p>Construir pipelines resilientes con Airflow es un equilibrio entre anticipar fallos, implementar retries inteligentes, garantizar idempotencia y mantener una buena visibilidad del sistema. Estas prÃ¡cticas no solo evitan llamadas de emergencia a media noche, sino que tambiÃ©n aseguran la integridad y disponibilidad de los datos en toda la organizaciÃ³n.</p>
<p>En prÃ³ximos posts, exploraremos patrones avanzados de Airflow como los sensores dinÃ¡micos y estrategias para manejar dependencias externas.</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"Happy data engineering!"</span> <span class="token operator">></span> /dev/stdout</code></pre>

  </div>
  
  <div class="post-navigation">
    <a href="/">> cd ..</a>
  </div>
</article>

      </div>
      
      <div class="terminal-footer">
        <p>Â© 2025 VALDEZDATA - Built with <a href="https://www.11ty.dev/">11ty</a> and ğŸ’™</p>
      </div>
    </div>
  </div>
  
  <script src="/js/terminal.js"></script>
</body>
</html>
